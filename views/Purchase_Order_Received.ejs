<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script>
      const ws = new WebSocket("ws://localhost:8001");
      ws.onmessage = receiveMessage;
    </script>
    <%- include ('header_login.ejs') %> <% if(typeof(pass) === 'undefined') { %>
    <script type="text/javascript">
      alert("비정상적인 접근입니다.");
      window.location.href = "/";
    </script>
    <% } else if(pass == 'NONE') { %>
    <script type="text/javascript">
      alert("로그인이 필요합니다.");
      window.location.href = "/";
    </script>
    <% } else if(typeof(req) === 'undefined') { %>
    <script type="text/javascript">
      alert("req 없음");
      window.location.href = "/";
    </script>
    <% } %>

    <style>
      input {
        outline: none;
        border: none;
      }

      li {
        list-style: none;
      }
      img {
        width: 100%;
      }
      .real-upload {
        display: none;
      }

      .upload {
        width: 20px;
        height: 20px;
        background-color: #444444;
      }

      .image-preview {
        gap: 20px;
      }
    </style>
  </head>
  <body>
    <div style="height: 50px"></div>

    <div class="d-flex flex-wrap justify-content-center">
      <div class="col_resize_empty">&nbsp;</div>
      <table class="table table-hover" id="POtable" onclick="toggletoggle()">
        <thead>
          <tr>
            <th scope="col">제목</th>
            <th scope="col">받은 업체</th>
            <th scope="col">보낸 업체</th>
            <th scope="col">최초작성일</th>
          </tr>
        </thead>
        <tbody>
          <%var i = 0;%> <% for (var key in req.session.Received_Order) { %>
          <tr>
            <th scope="row"><%= req.session.Received_Order[i]["Title"] %></th>
            <td><%=req.session.Received_Order[i]["Contractor"]%></td>
            <td><%= req.session.Received_Order[i]["Order_Company"] %></td>
            <td>
              <%=
              req.session.Received_Order[i]["FirstOrder_date"].split('T')[0]; %>
            </td>
          </tr>
          <%i++;%> <%}%>
        </tbody>
      </table>
      <div class="col_resize">
        <div
          class="col-12"
          style="text-align: center; background-color: white; display: none"
          id="myDIV"
        >
          <button
            type="button"
            onclick="toggleDiv(myDIV);
                    toggleDiv(myDIV2);
                    toggleDiv(POtable);"
            style="
              float: left;
              background-color: transparent;
              border: transparent;
            "
          >
            <i class="bi bi-x-lg"></i>
          </button>

          <button
            onclick="window.open('/PO_edit','_blank')"
            style="font-size: 2vmin; justify-items: end"
            class="btn btn-light"
          >
            수정
          </button>
          <script>
            for (i = 1; i < 7; i++) {
              const newDiv = document.createElement("div");
              newDiv.id = "Purchase_Order_" + i;
              newDiv.isConnected;
              myDIV.append(newDiv);
            }
          </script>
        </div>
        <div class="col_resize_empty_2"></div>
        +--------------------------------------------------------------------
        <!--채팅창 파트!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!-->
        <div
          class="col_resize_chat content"
          id="myDIV2"
          style="display: none; text-align: center; font-size: 1.75vw"
        >
          <div>
            <div
              id="table-d"
              style="
                background-color: #d2e9f2;
                border: var(--bs-border-color-translucent) 1px solid;
              "
            >
              날짜 연월
            </div>
            <div
              id="chat_tables"
              class="col-12 test"
              style="
                word-break: break-all;
                border: var(--bs-border-color-translucent) 1px solid;
                background-color: #d2e9f2;
                min-height: 600px;
                max-height: 1100px;
                height: calc(82vh - 150px);
                overflow-y: scroll;
              "
            ></div>
          </div>
          <div id="myDIV3" class="d-sm-flex">
            <input
              type="text"
              rows="3"
              id="txt_on"
              style="width: 100%; border: transparent; outline: none"
              onkeydown="enterkey()"
            />
            <button
              type="button"
              onclick=" sendMessage();"
              class="btn btn-secondary"
              style="
                border: var(--bs-border-color-translucent) 1px solid;
                border-radius: 0;
              "
            >
              <i class="bi bi-send"></i>
            </button>
          </div>
        </div>
      </div>
      <div class="col_resize_empty">&nbsp;</div>
    </div>
  </body>
</html>

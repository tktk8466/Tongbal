<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <%- include ('header_login.ejs') %>

    <!-- 웹소켓 클라이언트 접속 -->
    <script>
      const ws = new WebSocket("ws://localhost:8080");
      ws.onopen = () => {
        console.log("connected at server");
      };
      ws.onclose = () => {
        console.log("disconnected from server");
      };
      ws.onerror = () => {
        console.log("connection error");
      };
      //ws.onmessage = chat_reload(chat_tables_<%=key%>); //웹 소켓에서 메세지가 날아오면 실행되는 함수
    </script>

    <!--비정상 접근 차단-->
    <% if(typeof(pass) === 'undefined') { %>
    <script type="text/javascript">
      alert("비정상적인 접근입니다.");
    </script>
    <% } else if(pass == 'NONE') { %>
    <script type="text/javascript">
      alert("로그인이 필요합니다.");
    </script>
    <% } else if(typeof(req) === 'undefined') { %>
    <script type="text/javascript">
      //location.reload();
    </script>
    <% }%>
  </head>

  <body>
    <div class="d-flex justify-content-center">
      <div class="col-6" style="height: 50px; line-height: 100px; font-size: 30px"></div>
    </div>

    <div class="d-flex justify-content-center">
      <div class="col-6">
        <div class="card">
          <p
            class="card-title"
            style="
              text-align: center;
              font-size: 30px;
              border-bottom: var(--bs-border-color-translucent) 1px solid;
              background: #f7cb83;
              color: white;
            "
          >
            받은 발주서
          </p>
          <div class="card-body align-items-center">
            <div class="d-flex flex-column align-content-center flex-wrap">
              <table>
                <tr>
                  <th scope="col">제목</th>
                  <th scope="col">보낸 업체</th>
                  <th scope="col">발주일</th>
                  <th scope="col">납품기한</th>
                </tr>
                <%if (typeof(req.session.Received_Order) !== 'undefined' ) { for (var key in req.session.Received_Order) { %>
                <tr>
                  <th scope="row"><%= req.session.Received_Order[key]["Title"] %></th>
                  <td><%= req.session.R_CompanyInfo[key]["Comp_NAME"] %></td>
                  <td><%= req.session.Received_Order[key]["Order_Date"].split(' ')[0] %></td>
                  <td><%= req.session.Received_Order[key]["Delivery_Date"].split(' ')[0] %></td>
                </tr>
                <%}}%>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="d-flex justify-content-center">
      <div class="col-6">
        <div class="card">
          <p
            class="card-title"
            style="
              text-align: center;
              font-size: 30px;
              border-bottom: var(--bs-border-color-translucent) 1px solid;
              background: #f7cb83;
              color: white;
            "
          >
            보낸 발주서
          </p>
          <div class="card-body align-items-center">
            <div class="d-flex flex-column align-content-center flex-wrap">
              <table>
                <tr>
                  <th scope="col">제목</th>
                  <th scope="col">받은 업체</th>
                  <th scope="col">발주일</th>
                  <th scope="col">납품기한</th>
                </tr>
                <%if (typeof(req.session.Send_Order) !== 'undefined' ) { for (var key in req.session.Send_Order) { %>
                <tr>
                  <th scope="row"><%= req.session.Send_Order[key]["Title"] %></th>
                  <td><%= req.session.S_CompanyInfo[key]["Comp_NAME"] %></td>
                  <td><%= req.session.Send_Order[key]["Order_Date"].split(' ')[0] %></td>
                  <td><%= req.session.Send_Order[key]["Delivery_Date"].split(' ')[0] %></td>
                </tr>
                <%}}%>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
